#!/usr/bin/env php
<?php

declare(strict_types=1);

use Gacela\Framework\Bootstrap\GacelaConfig;
use Gacela\Framework\Gacela;
use Phel\Console\Infrastructure\ConsoleBootstrap;

$projectRootDir = getcwd() . DIRECTORY_SEPARATOR;
$autoloadPath = $projectRootDir . 'vendor' . DIRECTORY_SEPARATOR . 'autoload.php';

if (!file_exists($autoloadPath)) {
    exit("Cannot load composer's autoload file: {$autoloadPath}\n");
}

require $autoloadPath;

$configFn = static function (GacelaConfig $config): void {
    $config->addAppConfig('phel-config.php', 'phel-config-local.php');
};

Gacela::bootstrap($projectRootDir, $configFn);

$bootstrap = new ConsoleBootstrap();
$bootstrap->run();
